import{t as $,a as n,b as B}from"../chunks/FYrJzXzo.js";import"../chunks/CM28Q3F9.js";import{p as re,l as ae,j as se,f as oe,a as le,t as ne,s as r,g as a,b as o,h as ie,$ as ce,d as i,e as de,c as E,n as F,r as w}from"../chunks/BWQv4ORO.js";import{h as ue}from"../chunks/DGJXvoP4.js";import{p as pe,i as L,s as fe,a as v,b as me}from"../chunks/Agn4hVUl.js";import{E as ve,W as $e,N as R,F as _e,c as q,i as A,M as ge,e as he,a as be}from"../chunks/eV_I911L.js";import{s as ye}from"../chunks/DbZDx95u.js";import{i as xe}from"../chunks/aOCAfh_U.js";import{e as Ee,f as I}from"../chunks/KVacng_F.js";import{P as J}from"../chunks/BGOVFCWW.js";import{L as we}from"../chunks/eamTvpPT.js";import{g as Ae}from"../chunks/Cjz5tElU.js";import{A as Pe}from"../chunks/HouU0xVH.js";import{E as Te}from"../chunks/CmmBX89c.js";import{A as Ue}from"../chunks/C-tBEKg_.js";var Me=$('<meta name="description">'),Se=$('<form class="w-full block" method="POST"><div class="w-full flex flex-col space-y-4 p-4 sm:p-6"><!> <!> <!></div></form>'),Ne=$('<div class="border-t-2 border-gray-100"><div class="max-w-screen-md mx-auto px-6 pt-8 sm:pt-12"><div class="font-bold text-sm">READ NEXT</div></div> <!></div>'),Oe=$("<!> <!> <!> <!> <!> <!> <!>",1);function Ge(X,P){re(P,!1);const[Y,C]=fe(),T=()=>me(q,"$currentUser",Y);let t=pe(P,"data",8),c=i(!1),d=i(),U=i(),u=i(),_=i(),M,g=i();function S(){var e;r(d,t().title),r(U,t().teaser),r(u,t().content),r(_,t().published_at),M=t().updatedAt,r(g,(e=t().globalData)==null?void 0:e.cta),v(A,!1)}function G(){v(A,!0),r(c,!1)}async function H(){if(!T())return alert("Sorry, you are not authorized.");try{I("POST","/api/delete-article",{slug:t().slug}),Ae("/blog")}catch(e){console.error(e),alert("Error deleting the article. Try again."),window.location.reload()}}async function K(){if(!T())return alert("Sorry, you are not authorized.");const e=Ee(document.getElementById("article_content"));try{M=(await I("POST","/api/update-article",{slug:t().slug,title:a(d),content:a(u),teaser:e})).updatedAt,v(A,!1)}catch(s){console.error(s),alert("There was an error. You can try again, but before that, please just copy and paste your article into a safe place.")}}ae(()=>ie(t()),()=>{v(q,t().currentUser),S()}),se(),xe();var N=Oe();ue(e=>{var s=Me();ne(()=>{ce.title=a(d),ye(s,"content",a(U))}),n(e,s)});var O=oe(N);ve(O,{$$events:{cancel:S,save:K}});var k=o(O,2);$e(k,{get showUserMenu(){return a(c)},set showUserMenu(e){r(c,e)},$$legacy:!0});var D=o(k,2);{var Q=e=>{ge(e,{$$events:{close:()=>r(c,!1)},children:(s,h)=>{var l=Se(),p=E(l),f=E(p);J(f,{$$events:{click:G},children:(y,te)=>{F();var x=B("Edit post");n(y,x)},$$slots:{default:!0}});var m=o(f,2);J(m,{type:"button",$$events:{click:H},children:(y,te)=>{F();var x=B("Delete post");n(y,x)},$$slots:{default:!0}});var b=o(m,2);we(b,{}),w(p),w(l),n(s,l)},$$slots:{default:!0}})};L(D,e=>{a(c)&&e(Q)})}var W=o(D,2);Ue(W,{get title(){return a(d)},set title(e){r(d,e)},get content(){return a(u)},set content(e){r(u,e)},get published_at(){return a(_)},set published_at(e){r(_,e)},$$legacy:!0});var j=o(W,2);{var V=e=>{R(e,{children:(s,h)=>{var l=Ne(),p=o(E(l),2);he(p,1,()=>t().articles,be,(f,m,b)=>{Pe(f,{get article(){return a(m)},firstEntry:b===0})}),w(l),n(s,l)},$$slots:{default:!0}})};L(j,e=>{t().articles.length>0&&e(V)})}var z=o(j,2);R(z,{children:(e,s)=>{Te(e,{get cta(){return a(g)},set cta(h){r(g,h)},$$legacy:!0})},$$slots:{default:!0}});var Z=o(z,2);const ee=de(()=>`/blog/${t().slug}`);_e(Z,{get counter(){return a(ee)}}),n(X,N),le(),C()}export{Ge as component};
